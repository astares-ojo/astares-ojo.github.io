#!/usr/bin/env pwsh
#
##################################################################################
#
#                                   ^Y                                   
#                                  !@@#.                                 
#                                 Y&&@&&:                                
#                                G&5&@PP@7                               
#                              .##55&@GJ5&5                              
#                             :&B555&@GYYY&#.                            
#                            !&G5555&@GYYYYB&:                           
#                           J&P55555&@GYYYYYG@7                          
#                          G&5555555&@GYYYYYY5&5                         
#                        .#&55555555&@BYYYYYYYY&#.                       
#                       :&B555555555&@BYYYYYYYYYB&:                      
#                      ~&G5555555555&@BYYYYYYYYYYP&7                     
#                     J&P55555555555&@#YYYYYYYYYYY5&5                    
#                    P&5555555555555&@#YYYYYYYYYYYYY##.                  
#                  .##55555555555555&@#YYYYYYYYYYYYYYB&:                 
#                 :&B555555555555555&@#YYYYYYYYYYYYYYYP&7                
#                ~&G5555555555555555&@#YYYYYYYYYYYYYYYY5&5               
#               J&P55555555555555555&@&YYYYYYYYYYYYYYYYYY##.             
#              P&5555555555555555555&@&YYYYYYYYYYYYYYYYYYYB&^            
#             ##55555555555555555555&@&YYYYYYYYYYYYYYYYYYYYP&7           
#           :&B555555555555555555555&@&YYYYYYYYYYYYYYYYYYYYY5&P          
#          ~&G5555555555555555555555&@&YYYYYYYYYYYYYYYYYYYYYYY##.        
#         ?&P55555555555555555555555&@&YYYYYYYYYYYYYYYYYYYYYYYYG&^       
#        P&5555555555555555555PGB#&&@&@&&#BGP5YYYYYYYYYYYYYYYYYYP&7      
#       B#55555555555555PGB#&&&#BG5J7!7?YPB#&&&&#BGP5YYYYYYYYYYYY5&P     
#     .&B55555555PGB##&&#BG5J?!!!!!!!!!!!!!!!7?YPB#&&&&#BP5YYYYYYYY##.   
#    ~&GY55PGB####BG5Y?7!!!!!!!!!!!!!!!!!!!!!!!!!!!!7?YPG##&&#BGP5YJG&^  
#   ?@BB####BP5J?7!!!!!777777777777777777777777777777!!!!!77JYPG##&&##@? 
#  7&###BGGPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP555PGG####7
#
#################################################################################

# Stop the script in case of errors
$ErrorActionPreference = 'Stop'

function Green
{
    process { Write-Host $_ -ForegroundColor Green }
}

function Red
{
    process { Write-Host $_ -ForegroundColor Red }
}

function Blue
{
    process { Write-Host $_ -ForegroundColor Blue }
}

function White
{
    process { Write-Host $_ -ForegroundColor White }
}

function Write-TypeWriter 
{
	[CmdletBinding()]
	param (
    [Parameter(Mandatory=$true)]
    [string]$Text 
 
)

 $Text.ToCharArray() | ForEach-Object {
    Write-Host $_  -ForegroundColor Green -NoNewline;
    Start-Sleep -Milliseconds 50
  }
  Write-Output "" 
}

Write-TypeWriter "Hello and welcome to the Astares OJO installer. This installer will guide"  
Write-TypeWriter "you and help you with the installation process for the tooling."

$allowedExecutionPolicy = @('Unrestricted', 'RemoteSigned', 'ByPass')
if ((Get-ExecutionPolicy).ToString() -notin $allowedExecutionPolicy) {
  Write-Output ""
  Write-Output "ERROR:" | Red
  Write-Output "PowerShell requires an execution policy in [$($allowedExecutionPolicy -join ", ")] to run the installer" | Red
  Write-Output ""
  Write-Output "For example, to set the execution policy to 'RemoteSigned' please run :"
  Write-Output "'Set-ExecutionPolicy RemoteSigned -scope CurrentUser'"
  Write-Output "and then try again."
  break
}

